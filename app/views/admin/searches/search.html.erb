<div class="container px-5 px-sm-0">
  <div class="row">
    <% if @range == "Patient" %>
      <h3>"<%= @word %>"の検索結果：<%= @patients.count %>件</h3>
      <% if @patients.count == 0 %>
        <div class="w-100">条件にあてはまる検索結果はありません</div>
      <% else %>
      <table class="table table-striped">
        <thead>
          <tr>
            <th>患者ID</th>
            <th>氏名</th>
            <th>メールアドレス</th>
            <th>ステータス</th>
          </tr>
        </thead>
        <tbody>
        <% @patients.each do |patient| %>
          <tr>
            <td><%= patient.id %></td>
            <td>
              <%= link_to admin_patient_path(patient.id) do %>
                <%= patient.last_name + patient.first_name %>
              <% end %>
            </td>
            <td><%= patient.email %></td>
            <td>
              <% if patient.is_unsubscribe_flag == false %>
                  有効会員
              <% elsif patient.is_unsubscribe_flag == true %>
                  無効会員
              <% end %>
            </td>
          </tr>
        <% end %>
        </tbody>
      </table>
      <% end %>
    <% elsif @range == "Reservation" %>
      <h3>"<%= @word %>"の検索結果：<%= @reservations.count %>件</h3>
      <% if @reservations.count == 0 %>
        <div class="w-100">条件にあてはまる検索結果はありません</div>
      <% else %>
        <table class="table table-striped">
        <thead>
          <tr>
            <th>受診開始日時</th>
            <th>予約作成日時</th>
            <th>患者ID</th>
            <th>患者氏名</th>
            <th>性別</th>
            <th>受診ステータス</th>
            <th></th>
          </tr>
        </thead>
        <% @reservations.each do |reservation| %>
        <tr>
          <td>
            <%= link_to admin_reservation_path(reservation.id) do %>
              <%= reservation.start_time.strftime("%Y/%m/%d %H:%M") %>
            <% end %>
          </td>
          <td><%= reservation.created_at.strftime("%Y/%m/%d %H:%M") %></td>
          <td><%= reservation.patient.id %></td>
          <td><%= reservation.patient.last_name + reservation.patient.first_name %></td>
          <td><%= reservation.patient.sex %></td>
          <td>
            <%= form_with model: reservation, url: admin_reservation_path(reservation.id), local: true do |f| %>
              <%= f.select :examination_status, Reservation.examination_statuses.keys %>
              <%= f.submit "変更", class:"btn btn-sm btn-success"%>
            <% end %>
          </td>
        </tr>
        <% end %>
      </table>
      <% end %>
    <% elsif @range == "Reception" %>
      <h3>"<%= @word %>"の検索結果：<%= @receptions.count %>件</h3>
      <% if @receptions.count == 0 %>
        <div class="w-100">条件にあてはまる検索結果はありません</div>
      <% else %>
        <table class="table table-striped">
        <thead>
          <tr>
            <th>受診開始日時</th>
            <th>受付作成日時</th>
            <th>患者ID</th>
            <th>患者氏名</th>
            <th>性別</th>
            <th>受診ステータス</th>
            <th></th>
          </tr>
        </thead>
        <% @receptions.each do |reception| %>
        <tr>
          <td>
            <%= link_to admin_reception_path(reception.id) do %>
              <%= reception.start_time.strftime("%Y/%m/%d %H:%M") %>
            <% end %>
          </td>
          <td><%= reception.created_at.strftime("%Y/%m/%d %H:%M") %></td>
          <td><%= reception.patient.id %></td>
          <td><%= reception.patient.last_name + reception.patient.first_name %></td>
          <td><%= reception.patient.sex %></td>
          <td>
            <%= form_with model: reception, url: admin_reception_path(reception.id), local: true do |f| %>
              <%= f.select :examination_status, Reception.examination_statuses.keys %>
              <%= f.submit "変更", class:"btn btn-sm btn-success"%>
            <% end %>
          </td>
        </tr>
        <% end %>
      </table>
      <% end %>
    <% else %>
      <h3>"<%= @word %>"の検索結果：<%= @examinations.count %>件</h3>
      <% if @examinations.count == 0 %>
        <div class="w-100">条件にあてはまる検索結果はありません</div>
      <% else %>
        <table class="table table-striped">
        <thead>
          <tr>
            <th>受診日時</th>
            <th>患者ID</th>
            <th>患者氏名</th>
            <th>生年月日</th>
            <th>性別</th>
            <th>作業ステータス</th>
            <th></th>
          </tr>
        </thead>
        <% @examinations.each do |examination| %>
        <tr>
          <% if examination.reception_id.nil? %>
          <td>
            <%= link_to admin_examination_path(examination.id) do %>
              <%= examination.reservation.start_time.strftime("%Y/%m/%d %H:%M") %>
            <% end %>
          </td>
          <td><%= examination.reservation.patient.id %></td>
          <td><%= examination.reservation.patient.last_name + examination.reservation.patient.first_name %></td>
          <td><%= examination.reservation.patient.birth_date.strftime("%Y/%m/%d") %></td>
          <td><%= examination.reservation.patient.sex %></td>
          <% else %>
          <td>
            <%= link_to admin_examination_path(examination.id) do %>
              <%= examination.reception.start_time.strftime("%Y/%m/%d %H:%M") %>
            <% end %>
          </td>
          <td><%= examination.reception.patient.id %></td>
          <td><%= examination.reception.patient.last_name + examination.reception.patient.first_name %></td>
          <td><%= examination.reception.patient.birth_date.strftime("%Y/%m/%d") %></td>
          <td><%= examination.reception.patient.sex %></td>
          <% end %>
          <td>
            <%= form_with model: examination, url: admin_examination_path(examination.id), local: true do |f| %>
              <%= f.select :update_status, Examination.update_statuses.keys %>
              <%= f.submit "変更", class:"btn btn-sm btn-success"%>
            <% end %>
          </td>
        </tr>
        <% end %>
      </table>
      <% end %>
    <% end %>
  </div>
</div>


